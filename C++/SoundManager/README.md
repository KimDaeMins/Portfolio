# SoundManager(FMOD)

## 사운드 기술을 총괄하는 매니저 구현

## 핵심 코드

<img width="1013" alt="6-ADd" src="https://github.com/KimDaeMins/Portfolio/assets/68540137/9748009d-ccd4-4b72-ad96-cca26df1e8a2">

  사운드 재생, 볼륨조절, 좌 우 사운드 변화, 멈춤, 배경음악 반복재생, 멀티사운드를 구현헀습니다.

  재생 및 조절은 FMOD 라이브러리를 이용했습니다.

### 멀티사운드

#### 1. 멀티사운드를 구현하기 위하여 채널을 미리 생성해둡니다
    
    1-1. 싱글사운드랑 멀티사운드를 구분하기 위하여 vector<vector<channel>>형식으로 둔 후 첫 분류를 멀티사운드, 싱글사운드, BGM으로 나눴습니다. 두번쨰 분류는 각각 맞는 채널입니다.

   구현위치 - SoundManager.cpp Line[6-17]

#### 2. 재귀함수를 이용하여 비었거나 재생완료된 채널을 찾아서 사운드 재생합니다.

    2-1. FMOD_Channel_IsPlaying 함수를 통해 사운드 재생 여부를 판단하여 재생합니다

    2-2. 만약 현재 채널에 사운드가 재생중이라면 다음 채널에서 재생 후 재생중인 채널의 인덱스를 반환합니다.(재귀)

    2-3. 3D사운드의 경우 사운드 재생 과정에서 재생되는 위치를 받아와 플레이어랑 비교하여 거리 측정 후 사운드의 크기와 좌 우를 조절했습니다.

    구현위치 - SoundManager.cpp Line[109-218]

## 멀티사운드 배열 탐색 개선사항

  멀티사운드를 구현할 떄 계속 0부터 순차적으로 탐색을 하니 효율이 떨어진다고 생각해서 멀티사운드에서도 인덱스를 전달받도록 설정했습니다.

  그러나 결국 인덱스를 전달받더라도 거기서부터 순차적으로 판단하는건 변함이 없고, 채널을 임의로 지정해줘야하는 불편함이 있었습니다.

  이에 대한 개선사항으로 생각했던것이 3개 있었습니다.

  처음으로 랜덤값을 그때그때 설정하여 순회하는 방법을 고민했습니다. 
  
  배열순회자체는 랜덤값으로 좋겠지만 랜덤값을 추출하는 과정(한개만 추출하면 계속 랜덤을 돌리기떄문에 랜덤배열을 만들어야합니다)이나
  
  우연으로 랜덤값이 계속 겹치게된다면 성능상의 이득이 크지 않을거라고 판단했습니다. 

  실시간으로 채널을 생성하는건 어떨까 생각했지만 FMOD_SytemInit을 써야하기떄문에 효율적이진 않습니다.

  ★마지막으로 인덱스를 멤버변수로 두고 자체적으로 늘려가며 사용하는걸 고민했습니다. 자체적으로 늘리다가 최대 채널수를 넘어가면 1부터 다시 판단 재생중이라면 다음 인덱스 탐색

  -> 문제점이라면 무한루프에 빠질수있다는건데 스타팅포인트를 들고있다면(반복 제한) 문제 없을 것 같습니다. 
